import os
import sys

root = os.path.dirname(os.path.dirname(os.path.dirname(os.path.dirname(os.path.abspath(__file__)))))
sys.path.append(root)

# ----------------------------------------------------------------------------

# PLEASE DO NOT EDIT THIS FILE, IT IS GENERATED AND WILL BE OVERWRITTEN:
# https://github.com/ccxt/ccxt/blob/master/CONTRIBUTING.md#how-to-contribute-code

# ----------------------------------------------------------------------------
# -*- coding: utf-8 -*-

import ccxt.async_support as ccxt  # noqa: F402
from ccxt.test.exchange.base import test_shared_methods  # noqa E402

def test_index_by():
    exchange = ccxt.Exchange({
        'id': 'sampleexchange',
    })
    # Test 1: Basic list of dicts with string key
    input1 = [{
    'id': 'a',
    'val': 1,
}, {
    'id': 'b',
    'val': 2,
}, {
    'id': 'c',
    'val': 3,
}]
    expected1 = {
        'a': {
            'id': 'a',
            'val': 1,
        },
        'b': {
            'id': 'b',
            'val': 2,
        },
        'c': {
            'id': 'c',
            'val': 3,
        },
    }
    result1 = exchange.index_by(input1, 'id')
    test_shared_methods.assert_deep_equal(exchange, None, 'testIndexBy', result1, expected1)
    # Test 2: Skip elements with None/undefined values
    input2 = [{
    'id': 'a',
    'val': 1,
}, {
    'id': 'b',
    'val': 3,
}]
    expected2 = {
        'a': {
            'id': 'a',
            'val': 1,
        },
        'b': {
            'id': 'b',
            'val': 3,
        },
    }
    result2 = exchange.index_by(input2, 'id')
    test_shared_methods.assert_deep_equal(exchange, None, 'testIndexBy', result2, expected2)
    # Test 3: Skip elements missing the key
    input3 = [{
    'id': 'a',
    'val': 1,
}, {
    'val': 2,
}, {
    'id': 'b',
    'val': 3,
}]
    expected3 = {
        'a': {
            'id': 'a',
            'val': 1,
        },
        'b': {
            'id': 'b',
            'val': 3,
        },
    }
    result3 = exchange.index_by(input3, 'id')
    test_shared_methods.assert_deep_equal(exchange, None, 'testIndexBy', result3, expected3)
    # Test 4: Empty array
    input4 = []
    expected4 = {}
    result4 = exchange.index_by(input4, 'id')
    test_shared_methods.assert_deep_equal(exchange, None, 'testIndexBy', result4, expected4)
    # Test 5: Duplicate keys (last one wins)
    input5 = [{
    'id': 'a',
    'val': 1,
}, {
    'id': 'a',
    'val': 2,
}, {
    'id': 'a',
    'val': 3,
}]
    expected5 = {
        'a': {
            'id': 'a',
            'val': 3,
        },
    }
    result5 = exchange.index_by(input5, 'id')
    test_shared_methods.assert_deep_equal(exchange, None, 'testIndexBy', result5, expected5)
    # Test 6: Numeric key values
    input6 = [{
    'code': 1,
    'name': 'one',
}, {
    'code': 2,
    'name': 'two',
}, {
    'code': 3,
    'name': 'three',
}]
    expected6 = {
        '1': {
            'code': 1,
            'name': 'one',
        },
        '2': {
            'code': 2,
            'name': 'two',
        },
        '3': {
            'code': 3,
            'name': 'three',
        },
    }
    result6 = exchange.index_by(input6, 'code')
    test_shared_methods.assert_deep_equal(exchange, None, 'testIndexBy', result6, expected6)
    # Test 7: List of arrays with integer key
    input7 = [['a', 1], ['b', 2], ['c', 3]]
    expected7 = {
        'a': ['a', 1],
        'b': ['b', 2],
        'c': ['c', 3],
    }
    result7 = exchange.index_by(input7, 0)
    test_shared_methods.assert_deep_equal(exchange, None, 'testIndexBy', result7, expected7)
    # Test 8: Single element
    input8 = [{
    'id': 'only',
    'val': 42,
}]
    expected8 = {
        'only': {
            'id': 'only',
            'val': 42,
        },
    }
    result8 = exchange.index_by(input8, 'id')
    test_shared_methods.assert_deep_equal(exchange, None, 'testIndexBy', result8, expected8)
