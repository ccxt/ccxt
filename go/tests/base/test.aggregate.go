package base

import ccxt "github.com/ccxt/ccxt/go/v4"

// PLEASE DO NOT EDIT THIS FILE, IT IS GENERATED AND WILL BE OVERWRITTEN:
// https://github.com/ccxt/ccxt/blob/master/CONTRIBUTING.md#how-to-contribute-code

func TestAggregate() {
	exchange := ccxt.NewExchange().(*ccxt.Exchange)
	exchange.DerivedExchange = exchange
	exchange.InitParent(map[string]interface{}{
		"id": "sampleexchange",
	}, map[string]interface{}{}, exchange)
	var bids interface{} = []interface{}{[]interface{}{789.1, 123}, []interface{}{789.1, 123}, []interface{}{123, 456}, []interface{}{789, 123}, []interface{}{789.1, 123}}
	var asks interface{} = []interface{}{[]interface{}{123, 456}, []interface{}{789, 123}, []interface{}{789.1, 123}}
	AssertDeepEqual(exchange, nil, "aggregate", exchange.Aggregate(exchange.SortBy(bids, 0)), []interface{}{[]interface{}{123, 456}, []interface{}{789, 123}, []interface{}{789.1, 369}})
	AssertDeepEqual(exchange, nil, "aggregate", exchange.Aggregate(exchange.SortBy(asks, 0)), []interface{}{[]interface{}{123, 456}, []interface{}{789, 123}, []interface{}{789.1, 123}})
	AssertDeepEqual(exchange, nil, "aggregate", exchange.Aggregate([]interface{}{}), []interface{}{})
	// Test 1: Simple aggregation - same price combined
	var result1 interface{} = exchange.Aggregate([]interface{}{[]interface{}{100, 1}, []interface{}{101, 2}, []interface{}{100, 0.5}})
	AssertDeepEqual(exchange, nil, "testAggregate", result1, []interface{}{[]interface{}{100, 1.5}, []interface{}{101, 2}})
	// Test 2: With extra fields (should be ignored)
	var result2 interface{} = exchange.Aggregate([]interface{}{[]interface{}{100, 1, "extra"}, []interface{}{101, 2, "data", "more"}})
	AssertDeepEqual(exchange, nil, "testAggregate", result2, []interface{}{[]interface{}{100, 1}, []interface{}{101, 2}})
	// Test 3: Zero volumes should be skipped
	var result3 interface{} = exchange.Aggregate([]interface{}{[]interface{}{100, 1}, []interface{}{101, 0}, []interface{}{102, 2}})
	AssertDeepEqual(exchange, nil, "testAggregate", result3, []interface{}{[]interface{}{100, 1}, []interface{}{102, 2}})
	// Test 4: Empty array
	var result4 interface{} = exchange.Aggregate([]interface{}{})
	AssertDeepEqual(exchange, nil, "testAggregate", result4, []interface{}{})
	// Test 5: Single entry
	var result5 interface{} = exchange.Aggregate([]interface{}{[]interface{}{100, 1}})
	AssertDeepEqual(exchange, nil, "testAggregate", result5, []interface{}{[]interface{}{100, 1}})
	// Test 6: Many same prices aggregated
	var result6 interface{} = exchange.Aggregate([]interface{}{[]interface{}{100, 0.1}, []interface{}{100, 0.2}, []interface{}{100, 0.3}, []interface{}{100, 0.4}})
	AssertDeepEqual(exchange, nil, "testAggregate", result6, []interface{}{[]interface{}{100, 1}})
	// Test 7: All zero volumes - empty result
	var result7 interface{} = exchange.Aggregate([]interface{}{[]interface{}{100, 0}, []interface{}{101, 0}, []interface{}{102, 0}})
	AssertDeepEqual(exchange, nil, "testAggregate", result7, []interface{}{})
	// Test 8: Preserves order of first occurrence
	var result8 interface{} = exchange.Aggregate([]interface{}{[]interface{}{103, 1}, []interface{}{101, 1}, []interface{}{102, 1}, []interface{}{101, 0.5}})
	AssertDeepEqual(exchange, nil, "testAggregate", result8, []interface{}{[]interface{}{103, 1}, []interface{}{101, 1.5}, []interface{}{102, 1}})
	// Test 9: Decimal prices
	var result9 interface{} = exchange.Aggregate([]interface{}{[]interface{}{100.5, 1}, []interface{}{100.5, 2}, []interface{}{101.5, 1}})
	AssertDeepEqual(exchange, nil, "testAggregate", result9, []interface{}{[]interface{}{100.5, 3}, []interface{}{101.5, 1}})
	// Test 10: Mixed zero and non-zero for same price
	var result10 interface{} = exchange.Aggregate([]interface{}{[]interface{}{100, 1}, []interface{}{100, 0}, []interface{}{100, 2}})
	AssertDeepEqual(exchange, nil, "testAggregate", result10, []interface{}{[]interface{}{100, 3}})
}
