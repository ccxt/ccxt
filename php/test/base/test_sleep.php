<?php
namespace ccxt;

// ----------------------------------------------------------------------------

// PLEASE DO NOT EDIT THIS FILE, IT IS GENERATED AND WILL BE OVERWRITTEN:
// https://github.com/ccxt/ccxt/blob/master/CONTRIBUTING.md#how-to-contribute-code

// -----------------------------------------------------------------------------
use React\Async;
use React\Promise;

function test_sleep() {
    return Async\async(function () {
        $exchange = new \ccxt\async\Exchange(array(
            'id' => 'sampleexchange',
        ));
        $start = $exchange->milliseconds();
        $sleep_amount = 100; // milliseconds
        Async\await($exchange->sleep($sleep_amount));
        $end = $exchange->milliseconds();
        $elapsed = $end - $start;
        // Allow a small margin of error due to execution time
        $margin_of_error = 20;
        $max_elapsed = $sleep_amount + $margin_of_error;
        assert($elapsed >= $sleep_amount, 'Elapsed time ' . ((string) $elapsed) . 'ms is less than sleep amount ' . ((string) $sleep_amount) . 'ms');
        assert($elapsed <= $max_elapsed, 'Elapsed time ' . ((string) $elapsed) . 'ms exceeds sleep amount ' . ((string) $max_elapsed) . 'ms');
    }) ();
}
