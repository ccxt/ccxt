<?php
namespace ccxt;
use \ccxt\Precise;

// ----------------------------------------------------------------------------

// PLEASE DO NOT EDIT THIS FILE, IT IS GENERATED AND WILL BE OVERWRITTEN:
// https://github.com/ccxt/ccxt/blob/master/CONTRIBUTING.md#how-to-contribute-code

// -----------------------------------------------------------------------------
include_once __DIR__ . '/test_shared_methods.php';
include_once __DIR__ . '/test_trade.php';

function test_order($exchange, $method, $entry, $symbol, $now) {
    $format = array(
        'info' => array(),
        'id' => '123',
        'clientOrderId' => '1234',
        'timestamp' => 1649373600000,
        'datetime' => '2022-04-07T23:20:00.000Z',
        'lastTradeTimestamp' => 1649373610000,
        'symbol' => 'XYZ/USDT',
        'type' => 'limit',
        'timeInForce' => 'GTC',
        'postOnly' => true,
        'side' => 'sell',
        'price' => $exchange->parse_number('1.23456'),
        'stopPrice' => $exchange->parse_number('1.1111'),
        'amount' => $exchange->parse_number('1.23'),
        'cost' => $exchange->parse_number('2.34'),
        'average' => $exchange->parse_number('1.234'),
        'filled' => $exchange->parse_number('1.23'),
        'remaining' => $exchange->parse_number('0.123'),
        'status' => 'ok',
        'fee' => array(),
        'trades' => [],
    );
    $empty_not_allowed_for = ['id'];
    // todo: skip some exchanges
    // const emptyNotAllowedFor = [ 'id', 'timestamp', 'symbol', 'type', 'side', 'price' ];
    assert_structure($exchange, $method, $entry, $format, $empty_not_allowed_for);
    assert_timestamp($exchange, $method, $entry, $now);
    //
    assert_in_array($exchange, $method, $entry, 'timeInForce', ['GTC', 'GTK', 'IOC', 'FOK']);
    assert_in_array($exchange, $method, $entry, 'status', ['open', 'closed', 'canceled']);
    assert_in_array($exchange, $method, $entry, 'side', ['buy', 'sell']);
    assert_in_array($exchange, $method, $entry, 'postOnly', [true, false]);
    assert_symbol($exchange, $method, $entry, 'symbol', $symbol);
    assert_greater($exchange, $method, $entry, 'price', '0');
    assert_greater($exchange, $method, $entry, 'stopPrice', '0');
    assert_greater($exchange, $method, $entry, 'cost', '0');
    assert_greater($exchange, $method, $entry, 'average', '0');
    assert_greater($exchange, $method, $entry, 'average', '0');
    assert_greater_or_equal($exchange, $method, $entry, 'filled', '0');
    assert_greater_or_equal($exchange, $method, $entry, 'remaining', '0');
    assert_greater_or_equal($exchange, $method, $entry, 'amount', '0');
    assert_greater_or_equal($exchange, $method, $entry, 'amount', $exchange->safe_string($entry, 'remaining'));
    assert_greater_or_equal($exchange, $method, $entry, 'amount', $exchange->safe_string($entry, 'filled'));
    if ($entry['trades'] !== null) {
        for ($i = 0; $i < count($entry['trades']); $i++) {
            test_trade($exchange, $method, $entry['trades'][$i], $symbol, $now);
        }
    }
    assert_fee($exchange, $method, $entry['fee']);
}
